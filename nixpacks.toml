[phases.build]
dependsOn = ['install']
cmds = [
    'npm run build',
]

[phases.install]
dependsOn = ['setup']
cmds = [
'mkdir -p /var/log/nginx && mkdir -p /var/cache/nginx',
'composer install --ignore-platform-reqs',
'npm ci',
]

[phases.setup]
nixPkgs = [
'(php82.withExtensions (pe: pe.enabled ++ [ pe.all.imagick ]))',
'nginx',
'libmysqlclient',
'php82Packages.composer',
'php82Extensions.imagick',
'nodejs_18',
'npm-9_x',
]
